<html>

	<head>
		<title>Websocket Test</title>
	</head>
	
	<style>
		body {
			font-family: Courier New;
			font-weight: bold;
			font-size: 12px;
		}
	</style>
	
	<script>
	
		wsConnect = function( url, port, onConnect ){
			var websocket = ( new WebSocket( "ws://" + String( url ) + ":" + String( port ) + "/" ) );
			websocket.onmessage = function( data ){
				data.data.text().then( function( dat_ ){ wsReceiveMessage( JSON.parse( dat_ ) ) } );
			};
			
			if( onConnect != undefined ){ onConnect(); }
			return websocket;
		};
		
		wsDisconnect = function( websocket ){
			websocket.close();
		};
		
		wsParseData = function( data ){
			data.data.text().then( function( dat ){ res = dat; } );
			return res;
		};
		
		wsReceiveMessage = function( message ){
			switch( message.type ){
				case "new_text": document.getElementById( "messageFeed" ).innerHTML += message.contents + "<br>"; break;
			}
			
			return;
		};
		
		mouseMove = function( event ){
			var data = {
				x: event.clientX / window.innerWidth,
				y: event.clientY / window.innerHeight
			};
			
			sock.send( JSON.stringify( data ) );
			return;
		};
	
	</script>
	
	<body onmousemove="mouseMove( event );">
		<script>
			sock = wsConnect( "81.99.154.12", 4130 );
		</script>
		
		<div id="messageFeed">
		</div>
	</body>

</html>